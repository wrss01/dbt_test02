[{"name": "sheet1", "metadata": {"smart_notebook": {"version": 1, "computation_mode": "", "package_manager": "", "base_environment": "", "packages": [], "kernelspec": {"display_name": "R", "language": "R", "name": "ir"}}}, "nbformat": 4, "nbformat_minor": 4, "cells": [{"cell_type": "code", "source": ["in_search <- function(vec, x) x %in% vec\n\nvec_search <- function(vec, x) any(x == vec)\n\nforeach_search <- function(vec, x) {\n  for (v in vec)\n    if (v == x)\n      return (TRUE)\n  FALSE\n}\n\nfor_search <- function(vec, x) {\n  for (i in 1:length(vec))\n    if (vec[i] == x)\n      return (TRUE)\n  FALSE\n}\n"], "execution_count": 1, "execution_state": "idle", "outputs": [], "metadata": {"smart_notebook": {"type": "code", "cell_id": "349fd5d49d6fc94fb39804a9d4b59334", "hide_input_from_viewers": false, "hide_output_from_viewers": false, "execution_start": 0, "execution_millis": 197, "source": ["in_search <- function(vec, x) x %in% vec\n\nvec_search <- function(vec, x) any(x == vec)\n\nforeach_search <- function(vec, x) {\n  for (v in vec)\n    if (v == x)\n      return (TRUE)\n  FALSE\n}\n\nfor_search <- function(vec, x) {\n  for (i in 1:length(vec))\n    if (vec[i] == x)\n      return (TRUE)\n  FALSE\n}\n"]}}}, {"cell_type": "code", "source": ["bench <- function(label, f, vec) {\n  f(vec[1:10], 0) #warmup\n  cat(paste0(label, \":\\n\"))\n  for (r in 1:3) { # three runs\n    cpu.time <- sum(\n      system.time(\n        nmatches <- sum(sapply(1:1000, function(x) f(vec, x))),\n        gcFirst = TRUE #runs garbage collector before timing\n      )[1:2] # cpu time = user time + system time\n    )\n    cat(paste(\"\\telapsed CPU time:\", cpu.time, \"seconds\\n\"))\n    cat(paste0(\"\\t\\tmatches: \", nmatches,\"\\n\"))\n  }\n  cat(\"\\n\")\n}"], "execution_count": 2, "execution_state": "idle", "outputs": [], "metadata": {"smart_notebook": {"type": "code", "cell_id": "7f90d2657b66b74f617905e7bd2f2491", "hide_input_from_viewers": false, "hide_output_from_viewers": false, "execution_start": 0, "execution_millis": 209, "source": ["bench <- function(label, f, vec) {\n  f(vec[1:10], 0) #warmup\n  cat(paste0(label, \":\\n\"))\n  for (r in 1:3) { # three runs\n    cpu.time <- sum(\n      system.time(\n        nmatches <- sum(sapply(1:1000, function(x) f(vec, x))),\n        gcFirst = TRUE #runs garbage collector before timing\n      )[1:2] # cpu time = user time + system time\n    )\n    cat(paste(\"\\telapsed CPU time:\", cpu.time, \"seconds\\n\"))\n    cat(paste0(\"\\t\\tmatches: \", nmatches,\"\\n\"))\n  }\n  cat(\"\\n\")\n}"]}}}, {"cell_type": "code", "source": ["v = scan(\"/home/vec.txt\", sep='\\n', what = integer(), quiet = TRUE)\ncat(paste(length(v), \"records\\n\"))"], "execution_count": 4, "execution_state": "idle", "outputs": [{"output_type": "stream", "name": "stdout", "text": ["1000000 records\n"]}], "metadata": {"smart_notebook": {"type": "code", "cell_id": "8ff59d22892038451a8a605851b3d771", "hide_input_from_viewers": false, "hide_output_from_viewers": false, "execution_start": 0, "execution_millis": 414, "source": ["v = scan(\"/home/vec.txt\", sep='\\n', what = integer(), quiet = TRUE)\ncat(paste(length(v), \"records\\n\"))"]}}}, {"cell_type": "code", "source": ["bench(\"IN\",      in_search,      v)\nbench(\"VEC\",     vec_search,     v)\nbench(\"FOREACH\", foreach_search, v)\nbench(\"FOR\",     for_search,     v)"], "execution_count": 6, "execution_state": "idle", "outputs": [{"output_type": "stream", "name": "stdout", "text": ["IN:\n\telapsed CPU time: 5.096 seconds\n\t\tmatches: 550\n\telapsed CPU time: 4.658 seconds\n\t\tmatches: 550\n\telapsed CPU time: 4.207 seconds\n\t\tmatches: 550\n\nVEC:\n\telapsed CPU time: 5.653 seconds\n\t\tmatches: 550\n\telapsed CPU time: 6.315 seconds\n\t\tmatches: 550\n\telapsed CPU time: 5.032 seconds\n\t\tmatches: 550\n\nFOREACH:\n\telapsed CPU time: 37.376 seconds\n\t\tmatches: 550\n\telapsed CPU time: 37.163 seconds\n\t\tmatches: 550\n\telapsed CPU time: 37.106 seconds\n\t\tmatches: 550\n\nFOR:\n\telapsed CPU time: 48.092 seconds\n\t\tmatches: 550\n\telapsed CPU time: 48.915 seconds\n\t\tmatches: 550\n\telapsed CPU time: 48.532 seconds\n\t\tmatches: 550\n\n"]}], "metadata": {"smart_notebook": {"type": "code", "cell_id": "de117ce4c3cf2c4569c82f1c0f3ea97f", "hide_input_from_viewers": false, "hide_output_from_viewers": false, "execution_start": 0, "execution_millis": 289393, "source": ["bench(\"IN\",      in_search,      v)\nbench(\"VEC\",     vec_search,     v)\nbench(\"FOREACH\", foreach_search, v)\nbench(\"FOR\",     for_search,     v)"]}}}, {"cell_type": "code", "source": [""], "execution_count": 0, "execution_state": "idle", "outputs": [], "metadata": {"smart_notebook": {"type": "code", "cell_id": "6417c6a772576744347abc8794ba7dbc", "hide_input_from_viewers": false, "hide_output_from_viewers": false, "execution_start": 0, "execution_millis": 0, "source": [""]}}}], "inputVisible": false}]